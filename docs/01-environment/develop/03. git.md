---
title: git多账号配置
---

import { Badge } from '@theme';

:::warning
多个git账号指的是工作中为了一些原因需要使用公司提供的邮箱和用户名，然而在自己的代码开发中不期望使用这个用户名和邮箱。因此就需要在个人项目中配置一个git账号，在公司项目中配置另外一个git账号。
**如果你的项目中不需要多个git账号，那么你可以忽略这篇文章。**
:::

## 实现方案

这里推荐使用配置文件的方式进行配置，通过匹配目录+远程地址url的方式动态加载不同的配置文件。

:::tip 使用提示

该方案能够自动匹配，且便于项目管理。**但使用该方案需要用户合理划分目录**，例如文件夹A只放置A身份的项目，文件夹B只防止B身份的项目；或者可以通过URL区分。

如果不满足上述要求，那么建议你使用别名的方式为特殊仓库进行单独配置

例如在`zsh`配置中添加一个`alias`让其设置

```
alias compgit='git config user.email "email";git config user.name "username";
```

:::

为了便于文件管理，我还是会把git的相关配置移动到`~/.config/git`目录下，入口`~/.gitconfig`引入主配置文件即可。

```config title="~/.gitconfig"
[include]
  path = ~/.config/git/config

```

> 有一些第三方工具会修改`~/.gitconfig`，这部分保留即可，只需要将个人配置例如`user.name`、`user.email`等删除替换为另外一个入口即可。

接下来`~/.config/git/config`才是配置的核心，它负责决定哪个项目使用哪套配置，**以下是一个模板，你需要按照你的真实情况来进行修改**

```config title="~/.config/git/config"
[include]
  # 默认加载的配置
  path = ~/.config/git/identity-default.conf

[core]
  # 配置一个全局忽略文件
  excludesfile = ~/.config/git/.gitignore_global
  autocrlf = input

[init]
  defaultBranch = main

# --------------------------
# 按路径匹配身份
# --------------------------
# 个人项目
[includeIf "gitdir:~/code/personal/"]
  path = ~/.config/git/identity-private.conf

# GitHub 上的开源项目
[includeIf "gitdir:~/code/third-party/"]
  path = ~/.config/git/identity-github.conf

# 公司项目（路径匹配）
[includeIf "gitdir:~/code/company/worker/"]
  path = ~/.config/git/identity-worker.conf

# --------------------------
# 按远程地址匹配身份（git >= 2.13）
# --------------------------
# GitHub 仓库
[includeIf "hasconfig:remote.*.url:github.com"]
  path = ~/.config/git/identity-github.conf

# 公司内部仓库
[includeIf "hasconfig:remote.*.url:git.worker.com"]
  path = ~/.config/git/identity-worker.conf

```

以上配置会优先按照路径进行匹配，例如`~/code/personal/`目录下的项目会使用`~/.config/git/identity-private.conf`这套配置，而`~/code/third-party/`目录下则会使用`~/.config/git/identity-github.conf`这套配置。如果在`~/code/personal/`目录中某个仓库是属于工作的或者其他的并且URL可以作为区分，那么也可以在下方按照路径匹配。

接下来就可以按照你的配置方式添加若干个模板

```config title="~/.config/git/identity-private.conf"
# 默认身份
[user]
  name = your name
  email = email@gmail.com
  # signingkey = ssh-ed25519 xxxx

[commit]
  # gpgsign = true

```

最后通过命令`git config --show-origin user.email`就可以查看你的配置是否生效

![20251019121000tj8RYJ05003553](https://file2.antmoe.com/image/2/2025/10/19/68f464ba1222b.png)

如图，如果提示的是指向你自己自定义的那个文件那么恭喜你成功了。

## 多SSH密钥

上面只描述了如何切换`name`和`email`，但是如果你不同项目有不同的`ssh`通行证，那么仍然需要设置对不同主机使用不同的ssh key。

:::tip

我个人推荐大家使用`SSH Agent`服务的，[bitwarden](https://bitwarden.com/help/ssh-agent/)或者[1password](https://developer.1password.com/docs/ssh/agent/)都有提供现成的服务。这样就不会有下边的一些复杂配置了。

:::

当然如果没有`SSH Agent`服务也没关系，也可以通过“复杂”的配置来实现不同项目使用不同的ssh key。

这里的配置文件统一使用的是`~/.ssh/config`文件，如果没有的话可以自行新建

以下是一个模板

```config title="~/.ssh/config"
# 默认设置（兜底配置）
Host *
  IdentityFile ~/.ssh/id_rsa_default
  AddKeysToAgent no
  StrictHostKeyChecking accept-new

# -----------------------------
# GitHub 账号（开源项目）
# -----------------------------
Host github.com
  HostName github.com
  User git
  IdentityFile ~/.ssh/id_rsa_github

# -----------------------------
# 公司项目（worker）
# -----------------------------
Host git.worker.com
  HostName git.worker.com
  User git
  IdentityFile ~/.ssh/id_rsa_worker

```

但这个配置同样会有一个问题，就是如果我有两个github仓库，但想使用不同的ssh key是没有办法做到的，因此**如果存在这种情况**则需求设置别名来实现，例如：

```config title="~/.ssh/config"
# 个人 GitHub
Host github.com-personal
  HostName github.com
  User git
  IdentityFile ~/.ssh/id_rsa_personal

# 公司 GitHub
Host github.com-work
  HostName github.com
  User git
  IdentityFile ~/.ssh/id_rsa_work

```

添加以上配置后，需要改动项目的`remote-url`，例如：`git remote set-url origin git@github.com-work:YourCompany/Repo.git`，这样才能匹配到`~/.ssh/id_rsa_work`这个ssh key。
